---
title: "MPG & Transmission Type Analysis"
output: html_document
---
##Executive Summary
Motor Trend magazine is interested in exploring the relationship between a specific set of variables and mpg; they are particularly interested in the following:

1. Is an automatic or manual transmission better for MPG?
2. Quantify the MPG difference between automatic and manual transmissions?


```{r  LoadLibrary, include=T, eval=T, echo=F}
    library(ggplot2);
```


##Data Processing
```{r DataProcessing, include=T, eval=T, echo=T}
#   Set Working Directory
    setwd("~/Data Science/07 Regression Models");

#   Read "mtcars" Data
    data(mtcars);
    dim(mtcars);
    head(mtcars, n=5);
```



## Exploratory Analysis
```{r BoxPlot, include=T, eval=T, echo=T}
#   Box Plot: MPG vs Transmission Type
    boxplot(mpg~am, data=mtcars, col=c("blue", "green"),
        xlab="Transmission (Manual=0, Auto=1)", ylab="MPG",
        main="MPG & Transmission Type"
    );
```

###Means Test
```{r MeansTest, include=T, eval=T, echo=T}
#   Aggregate Data & Calculated Mean for MPG & Transmission Type
    Mean <- aggregate(mpg~am, data=mtcars, mean);
    Mean;

#   Two Sample T-Test
    Automatic <- mtcars[mtcars$am==1, ];
    Manual <- mtcars[mtcars$am==0, ];
    MTest <- t.test(Automatic$mpg, Manual$mpg);
    MTest[3];
```


###Correlation Analysis
```{r CorAnalysis, include=T, eval=T, echo=T}
#   Correlation "mpg" Relative to Remaining Variables
    CorMatrix <- cor(mtcars)[1, ];
    CorMatrix;
```


##Model
###Linear Regression
```{r LRegression, include=T, eval=T, echo=T}
#   Linear Regression
    LRegression <- lm(mpg~am, data=mtcars);
    summary(LRegression);
```


###Multivariate Regression
```{r MRegression, include=T, eval=T, echo=T}
    MRegression <- step(lm(data=mtcars, mpg ~ .), trace=0, steps=10000);
    summary(MRegression);
    
    Best <- lm(mpg~am + wt + qsec, data = mtcars);
    anova(MRegression, Best);
    summary(Best);
```


## Appendix
```{r Appendix, include=T, eval=T, echo=T}
    par(mfrow = c(1, 2));

#   Histogram
    x <- mtcars$mpg;
    h<-hist(x, breaks=10, col="red", xlab="MPG",
       main="MPG Histogram");
    
    xfit<-seq(min(x), max(x), length=40);
    yfit<-dnorm(xfit, mean=mean(x), sd=sd(x));
    yfit <- yfit * diff(h$mids[1:2]) * length(x);
    lines(xfit, yfit, col="blue", lwd=2);
    
#   Density Plot
    d <- density(mtcars$mpg);
    plot(d, xlab="MPG", main="MPG Density Plot");
    
    plot(Best);
```
